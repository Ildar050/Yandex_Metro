# Тестирование мобильного приложения Яндекс.Метро на Android Studio



Яндекс Метро — сервис, который позволяет ориентироваться в метро с помощью
мобильного устройства. В приложении есть схема метро, которая помогает
построить маршрут и оценить время в пути. В нём также появляются актуальные
уведомления о работе станций метро и изменениях графика работы.


<details> <summary> Требования по проекту </summary>

#### Макеты 
Макеты расположены по [ссылке](https://www.figma.com/file/RzH5SqcLWrIPnQQW2fmitu/Metro-Dev?node-id=0%3A1)

 #### Архитектура приложения. 
Яндекс Метро — это нативное приложение. Устанавливается на мобильное
устройство пользователя.

#### Поддерживаемые окружения
Поддерживаемые операционные системы: Android 9/10/11/12, iOS 13/14.
Разрешения экранов: 360x640, 375x812, 1080х1920.

#### Интерфейс.
В интерфейсе есть две функциональные области:
- карта метро,
- область ввода станций метро.


#### Карта.

Карта двумерная. Можно перемещать свайпом. Масштабируется пинчем и
спредом.
В стартовом состоянии:
- Если геолокация устройства пользователя определяется в городе с метро, то
активной отмечена станция «Откуда», ближе к которой находится устройство.
- Если геолокация устройства пользователя определяется в городе без метро,
то станция «Откуда» не отмечена.
Как отмечается активная станция — см. на макетах.


#### Построение маршруты.

Маршрут построится, только если заполнить поля «Откуда» и «Куда». Маршруты
на карте интерактивные — пользователь может выбирать тапом станции.

**Пользователь может построить маршрут:**
- **введя название станций в полях «Откуда» и «Куда»;**
- **выбрав станции тапом на карте, если включена опция «Выбор станции
касанием» в настройках;**
- **выбрав ранее построенный маршрут или станцию в истории маршрутов.**


#### Поля ввода «Откуда» и «Куда».

В стартовом состоянии в поле «Откуда»:
- Если геолокация устройства пользователя определяется в городе с метро, то
указана станция, ближе к которой находится устройство.
- Если геолокация устройства пользователя определяется в городе без метро,
то поле пустое.

Пользователь может поменять местами названия станций в полях с помощью
кнопки со стрелочками. Если одно поле пустое, то при нажатии кнопки, название
станции перемещается между полями. Подробнее о работе кнопки при
заполненных полях и построенном маршруте см. в разделе «Информация о
маршруте». В альбомной ориентации поля отображаются в левом нижнем углу, подробнее см. на макетах.


#### Ограничения полей для построения маршрута.

| Название | Тип поля | Возможные значения|Обязательность|
| ----- | :-------: |:-------: |:-------: |
| Откуда  |  текстовое поле |Только буквы русского алфавита, цифры, пробел, тире. Длина не менее 1 и не более 50 символов. Пробелы до и после адреса исчезают при снятии фокуса. Если пользователь соблюдает правила ввода и под введённые символы попадает название станции, то оно отображается для выбора. Если правила не соблюдаются или станций, соответствующих введённым символам, не обнаружилось, станция не отображается. |Да|
| Куда |  текстовое поле |Только буквы русского алфавита, цифры, пробел, тире. Длина не менее 1 и не более 50 символов. Пробелы до и после адреса исчезают при снятии фокуса. Если пользователь соблюдает правила ввода и под введённые символы попадает название станции, то оно отображается для выбора. Если правила не соблюдаются или станций, соответствующих введённым символам, не обнаружилось, станция не отображается.|Да|

#### Выбор станции на карте.

Пользователь может выбрать станцию маршрута на карте:
- **тапом, если включена опция «Выбор станции касанием» в настройках,**
- введя название в поле «Откуда» или «Куда»,
- нажав в карточке станции кнопку «Отсюда» или «Сюда».
  
**Если станция не была выбрана раньше, то при выборе эта станция**
**выделяется, всплывает её карточка. Если станция уже была выбрана**
**раньше, сразу всплывает карточка.**

Как выглядит станция в разных режимах — см. макеты.

#### Карточка станции.

В карточке станции доступны кнопки выбора точки маршрута: «Отсюда» и «Сюда».

У карточки несколько состояний и переходов:
- Если пользователь ещё не выбирал станции для построения маршрута, то при
нажатии кнопки карточка закрывается, в поле ввода названия станции
добавляется название выбранной станции.
- Если после нажатия кнопки строится маршрут, то карточка станции
закрывается.
- Если пользователь нажимает «Отсюда» или «Сюда» на той же станции, что
уже была выбрана, но в другой последовательности, то точки А и В и названия
станций в полях «Отсюда» и «Куда» меняются местами.

Также в карточке отображается:
- название станции;
- номер и название линии метро;
- время открытия и закрытия станции;
- блок с Яндекс Картой и кнопкой «Показать выходы»;
- блок с Яндекс Go;
- кнопка «Добавить станцию в избранное»;
- кнопка «Сообщить об ошибке».
  
Пользователь может свайпом вверх открыть всю карточку станции.
Пользователь может закрыть карточку станции свайпом вниз или нажав на кнопку с крестиком. 

Расположение элементов см. на макетах.
В альбомной ориентации карточка отображается в левом углу экрана, подробнее
см. на макетах.


#### История о маршруте.

Окно с историей о маршруте раскрывается при нажатии на поля «Откуда» и
«Куда». В истории сохраняются как маршруты, так и названия выбранных станций. 

Маршрут и выбранные станции сохраняются в истории после того, как
пользователь построил маршрут.

Маршрут хранится только один — последний построенный.

**Новые станции появляются сверху списка в истории, а станция, которая**
**была первой в списке становится последней.**

**История должна сохраняться в следующих версиях приложения.**

Пользователь может закрыть окно с помощью кнопки «Отменить».


#### Логика построения маршрута.

Маршрут можно построить, только если заполнить поля «Откуда» и «Куда». Как на карте отображается построенный маршрут — см. в макетах.

После построения маршрута всплывает окно с информацией о маршруте.

Пользователь может сбросить маршрут тапом на крестик в окне информации о
маршруте. При закрытии маршрута в поле «Откуда» сохраняется начальная
станция из последнего маршрута. Поле «Куда» и маршрут на схеме сбрасываются, выделение станций пропадает (кроме начальной станции).


#### Информация о маршруте.

Окно с информацией о маршруте открывается после того, как пользователь
выбрал станции маршрута. В альбомной ориентации окно отображается в левом
углу экрана, подробнее см. на макетах.

Пользователь может поменять местами названия станций в полях с помощью
кнопки со стрелочками.

По умолчанию в окне отображаются:
- графические элементы;
- общее время в пути;
- временной интервал маршрута: время отправления и прибытия;
- количество пересадок, если они есть;
- кнопка «Детали маршрута»;
- кнопка «Закрыть»;
- поля «Откуда» и «Куда».
  
Подробности см. на макетах.

**Если текущее время превышает время окончания маршрута, то временной**
**интервал маршрута обновляется. Например, если изначально время**
**маршрута было указано в интервале с 10:45 до 11:00, но текущее время —**
**уже 11:01, то интервал обновится.**

Пользователь может свернуть окно свайпом вниз. Останется только время в пути и названия станций маршрута.

Окно можно закрыть при нажатии на кнопку с крестиком. Маршрут сбросится —
см. блок «Логика построения маршрута».

В портретной ориентации окно разворачивается свайпом вверх. Откроется
детальная информация о маршруте. Также в детали можно попасть по нажатию кнопки «Детали маршрута».

#### Детали маршрута.

В деталях маршрута отображаются:
- участки маршрута, разделённые сообщениями о пересадке;
- сообщение об удобных вагонах для посадки;
- картинка с указанием удобных вагонов;
- станции отправления и прибытия;
- пересадочные станции;
- промежуточные станции;
- кнопка i;
- событие на станции;
- название станции, номер линии и иконка сервиса — для станций,
расположенных в начале каждого участка

**При смене ориентации с портретной на ландшафтную детали маршрута
отображаются в левой части экрана.**

Пользователь может закрыть окно с деталями маршрута либо свайпом вниз, либо
нажав кнопку «Закрыть». В этом случае отображается информация о маршруте —
см. блок «Информация о маршруте». Построенный маршрут не сбрасывается.

#### Смена ориентации экрана.

**При смене ориентации экрана масштаб построенного маршрута сохраняется**
**в том состоянии, которое выбрал пользователь.**

Построенный маршрут должен вписываться в отведённую область экрана на
карте.

**Карточки маршрута, станции и настроек сохраняют своё положение при**
**переходе из портретной ориентации в альбомную и обратно: свёрнутые**
**остаются свёрнутыми, открытые — открытыми, среднее положение**
**переходит в среднее.**

#### Логика работы лонг-тапа по станции метро.

**При нажатии на станцию при помощи лонг-тапа открывается окно карточки
станции с кнопками «Отсюда» и «Сюда». При этом схема остаётся в том же
положении, которое выбрал пользователь.**

При нажатии на станцию и перемещении фокуса на другую станцию окно карточки
станции остаётся открытым, в ней отображается информация о той станции, на
которую сместился фокус.

**Если пользователь отпустил лонг-тап, а фокус был в пустой области карты,
то окно карточки станции закроется.**

#### Настройки.

В настройках пользователь может выбрать город, язык и тему, а также очистить
историю поиска, узнать версию приложения и оставить обратную связь.

#### Язык.

В текущей версии пользователь может выбрать один из двух языков: русский или
английский.

#### Тема.

Пользователь может выбрать тёмную тему:
- Если тёмная тема выключена, то отображается светлая.
- Если тёмная тема включена, то пользовательский интерфейс отображается в
тёмном цвете.
- Если выставлен режим «Автоматически», то тема меняется автоматически: со
светлой на тёмную в 18:00, с тёмной на светлую в 6:00. Время московское.

#### Очистить историю поиска.

Пользователь может очистить историю поиска и маршрутов, нажав кнопку
«Очистить историю поиска». Откроется всплывающее окно с подтверждением
удаления. При нажатии кнопки «Удалить» история поиска и маршрутов удаляется.

#### О приложении.
Пользователь может посмотреть версию сборки приложения и дополнительную
информацию.

#### Обратная связь.
Пользователь может оставить обратную связь. При нажатии на кнопку «Обратная
связь» происходит переход в окно службы поддержки с помощью Webview.

#### Авиарежим или отсутствие соединения
**При отсутствии интернет-соединения появляется уведомление об ошибке.**

 </details>

 <details> <summary> Задачи </summary>

1. Провести тест-анализ требований на валидацию полей.
2. Создать набор тест-кейсов на проверку валидации полей формы Яндекс Маршрутов. Применить техники тест-дизайна: классы эквивалентности и граничные значения.
3. Протестировать валидацию полей и завести баг-репорты, если есть баги.
4. Провести тест-анализ требований расчёта времени и стоимости маршрута на собственном автомобиле. 
5. Применить технику тест-дизайна «Классы эквивалентности» и создать набор тест-кейсов на проверку правильности расчета времени и стоимости поездки на собственном автомобиле.
6. Протестировать расчеты и завести баг-репорты, если есть баги.
 
  </details>

 <details> <summary> Реализация </summary> 
 
 #### Тестовая документация включающая в себя: Тест-анализ, Классы эквивалентности и граничные значения, Тест-кейсы, Баг-репорты.

  [Проект 1 спринта](https://docs.google.com/spreadsheets/d/1rWzQs96ot4CXB1geR6YU4wnvvPzNokVEJbn--QOsTng/edit?usp=sharing)

 </details>